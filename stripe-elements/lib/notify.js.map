{
  "version": 3,
  "sources": ["../src/lib/notify.ts"],
  "sourcesContent": ["import type { ReactiveController, ReactiveElement, ReactiveControllerHost } from 'lit';\n\nclass ChangeEvent extends Event {\n  public detail: { value: unknown };\n\n  constructor(\n    public key: string,\n    public oldValue: unknown,\n    public value: unknown,\n    attribute?: string|null,\n  ) {\n    super(`${attribute ?? key.toLowerCase()}-changed`);\n    this.detail = { value };\n  }\n}\n\nclass NotifyController implements ReactiveController {\n  private static instances = new Map<ReactiveControllerHost, NotifyController>();\n\n  cache = new Map();\n\n  constructor(private host: HTMLElement & ReactiveControllerHost) {\n    if (NotifyController.instances.has(host))\n      return NotifyController.instances.get(host);\n    host.addController(this);\n    NotifyController.instances.set(host, this);\n  }\n\n  hostUpdated() {\n    for (const [key, oldValue] of this.cache) {\n      const newValue = this.host[key];\n      const { attribute } = (this.host.constructor as typeof ReactiveElement)\n        .getPropertyOptions(key) ?? {};\n      const attr = typeof attribute === 'string' ? attribute : null;\n      this.cache.set(key, newValue);\n      this.host.dispatchEvent(new ChangeEvent(key, oldValue, newValue, attr));\n    }\n  }\n}\n\n\nexport function notify<T extends ReactiveElement>(proto: T, key: string) {\n  (proto.constructor as typeof ReactiveElement).addInitializer(x => {\n    const controller = new NotifyController(x);\n    controller.cache.set(key, x[key]);\n  });\n}\n"],
  "mappings": ";AAEA,IAAM,cAAN,cAA0B,MAAM;AAAA,EAG9B,YACS,KACA,UACA,OACP,WACA;AACA,UAAM,GAAG,aAAa,IAAI,YAAY,WAAW;AAL1C;AACA;AACA;AAIP,SAAK,SAAS,EAAE,MAAM;AAAA,EACxB;AACF;AAEA,IAAM,oBAAN,MAAqD;AAAA,EAKnD,YAAoB,MAA4C;AAA5C;AAFpB,iBAAQ,oBAAI,IAAI;AAGd,QAAI,kBAAiB,UAAU,IAAI,IAAI;AACrC,aAAO,kBAAiB,UAAU,IAAI,IAAI;AAC5C,SAAK,cAAc,IAAI;AACvB,sBAAiB,UAAU,IAAI,MAAM,IAAI;AAAA,EAC3C;AAAA,EAEA,cAAc;AACZ,eAAW,CAAC,KAAK,aAAa,KAAK,OAAO;AACxC,YAAM,WAAW,KAAK,KAAK;AAC3B,YAAM,EAAE,cAAe,KAAK,KAAK,YAC9B,mBAAmB,GAAG,KAAK,CAAC;AAC/B,YAAM,OAAO,OAAO,cAAc,WAAW,YAAY;AACzD,WAAK,MAAM,IAAI,KAAK,QAAQ;AAC5B,WAAK,KAAK,cAAc,IAAI,YAAY,KAAK,UAAU,UAAU,IAAI,CAAC;AAAA,IACxE;AAAA,EACF;AACF;AAtBA,IAAM,mBAAN;AACE,AADI,iBACW,YAAY,oBAAI,IAA8C;AAwBxE,gBAA2C,OAAU,KAAa;AACvE,EAAC,MAAM,YAAuC,eAAe,OAAK;AAChE,UAAM,aAAa,IAAI,iBAAiB,CAAC;AACzC,eAAW,MAAM,IAAI,KAAK,EAAE,IAAI;AAAA,EAClC,CAAC;AACH;",
  "names": []
}
