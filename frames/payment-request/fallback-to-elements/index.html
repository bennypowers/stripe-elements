<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Stripe Elements</title>

    <link rel="preconnect" href="https://ga.jspm.io"/>

    <link rel="stylesheet" href="/frames.css">

    <script async src="https://ga.jspm.io/npm:es-module-shims@0.12.8/dist/es-module-shims.min.js" crossorigin="anonymous"></script>

    <script type="importmap">{"imports":{"@stripe/stripe-js":"https://ga.jspm.io/npm:@stripe/stripe-js@1.22.0/","@power-elements/stripe-elements":"/stripe-elements/stripe-elements/index.js","@lavadrop/camel-case":"https://ga.jspm.io/npm:@lavadrop/camel-case@0.4.0/camelCase.js","@lavadrop/kebab-case":"https://ga.jspm.io/npm:@lavadrop/kebab-case@3.0.0/kebabCase.js","@material/mwc-button":"https://ga.jspm.io/npm:@material/mwc-button@0.26.0-canary.f3e28323.0/mwc-button.js","@material/mwc-dialog":"https://ga.jspm.io/npm:@material/mwc-dialog@1.0.0-canary.66f6244e.0/mwc-dialog.js","@material/mwc-textfield":"https://ga.jspm.io/npm:@material/mwc-textfield@0.26.0-canary.f3e28323.0/mwc-textfield.js","@pacote/memoize":"https://ga.jspm.io/npm:@pacote/memoize@1.1.6/lib/esm/index.js","@power-elements/json-viewer":"https://ga.jspm.io/npm:@power-elements/json-viewer@2.1.1/json-viewer.js","lit":"https://ga.jspm.io/npm:lit@2.0.2/index.js","lit/decorators.js":"https://ga.jspm.io/npm:lit@2.0.2/decorators.js","lit/directives/if-defined.js":"https://ga.jspm.io/npm:lit@2.0.2/directives/if-defined.js","tslib":"https://ga.jspm.io/npm:tslib@2.3.1/tslib.es6.js"},"scopes":{"https://ga.jspm.io/":{"@lit/reactive-element":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/reactive-element.js","@lit/reactive-element/decorators/custom-element.js":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/decorators/custom-element.js","@lit/reactive-element/decorators/event-options.js":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/decorators/event-options.js","@lit/reactive-element/decorators/property.js":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/decorators/property.js","@lit/reactive-element/decorators/query-all.js":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/decorators/query-all.js","@lit/reactive-element/decorators/query-assigned-elements.js":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/decorators/query-assigned-elements.js","@lit/reactive-element/decorators/query-assigned-nodes.js":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/decorators/query-assigned-nodes.js","@lit/reactive-element/decorators/query-async.js":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/decorators/query-async.js","@lit/reactive-element/decorators/query.js":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/decorators/query.js","@lit/reactive-element/decorators/state.js":"https://ga.jspm.io/npm:@lit/reactive-element@1.1.2/development/decorators/state.js","@material/base/foundation":"https://ga.jspm.io/npm:@material/base@14.0.0-canary.a986df922.0/foundation.js","@material/dialog/constants.js":"https://ga.jspm.io/npm:@material/dialog@6.0.0-canary.781434a92.0/constants.js","@material/dialog/foundation.js":"https://ga.jspm.io/npm:@material/dialog@6.0.0-canary.781434a92.0/foundation.js","@material/dom/events":"https://ga.jspm.io/npm:@material/dom@6.0.0-canary.781434a92.0/events.js","@material/dom/ponyfill":"https://ga.jspm.io/npm:@material/dom@14.0.0-canary.a986df922.0/ponyfill.js","@material/floating-label/foundation":"https://ga.jspm.io/npm:@material/floating-label@14.0.0-canary.a986df922.0/foundation.js","@material/line-ripple/foundation":"https://ga.jspm.io/npm:@material/line-ripple@14.0.0-canary.a986df922.0/foundation.js","@material/mwc-base/aria-property":"https://ga.jspm.io/npm:@material/mwc-base@0.25.3/aria-property.js","@material/mwc-base/base-element":"https://ga.jspm.io/npm:@material/mwc-base@0.26.0-canary.f3e28323.0/base-element.js","@material/mwc-base/base-element.js":"https://ga.jspm.io/npm:@material/mwc-base@1.0.0-canary.66f6244e.0/base-element.js","@material/mwc-base/form-element":"https://ga.jspm.io/npm:@material/mwc-base@0.26.0-canary.f3e28323.0/form-element.js","@material/mwc-base/observer":"https://ga.jspm.io/npm:@material/mwc-base@0.26.0-canary.f3e28323.0/observer.js","@material/mwc-floating-label":"https://ga.jspm.io/npm:@material/mwc-floating-label@0.26.0-canary.f3e28323.0/mwc-floating-label-directive.js","@material/mwc-icon/mwc-icon":"https://ga.jspm.io/npm:@material/mwc-icon@0.26.0-canary.f3e28323.0/mwc-icon.js","@material/mwc-line-ripple":"https://ga.jspm.io/npm:@material/mwc-line-ripple@0.26.0-canary.f3e28323.0/mwc-line-ripple-directive.js","@material/mwc-notched-outline":"https://ga.jspm.io/npm:@material/mwc-notched-outline@0.26.0-canary.f3e28323.0/mwc-notched-outline.js","@material/mwc-ripple/mwc-ripple":"https://ga.jspm.io/npm:@material/mwc-ripple@0.26.0-canary.f3e28323.0/mwc-ripple.js","@material/mwc-ripple/ripple-handlers":"https://ga.jspm.io/npm:@material/mwc-ripple@0.26.0-canary.f3e28323.0/ripple-handlers.js","@material/notched-outline/foundation":"https://ga.jspm.io/npm:@material/notched-outline@14.0.0-canary.a986df922.0/foundation.js","@material/ripple/foundation":"https://ga.jspm.io/npm:@material/ripple@14.0.0-canary.a986df922.0/foundation.js","@material/textfield/foundation":"https://ga.jspm.io/npm:@material/textfield@14.0.0-canary.a986df922.0/foundation.js","blocking-elements":"https://ga.jspm.io/npm:blocking-elements@0.1.1/dist/blocking-elements.js","lit":"https://ga.jspm.io/npm:lit@2.1.1/index.js","lit-element":"https://ga.jspm.io/npm:lit-element@2.5.1/lit-element.js","lit-element/lit-element.js":"https://ga.jspm.io/npm:lit-element@3.1.1/development/lit-element.js","lit-html":"https://ga.jspm.io/npm:lit-html@2.1.1/development/lit-html.js","lit-html/directive.js":"https://ga.jspm.io/npm:lit-html@2.1.1/development/directive.js","lit-html/directives/class-map":"https://ga.jspm.io/npm:lit-html@1.4.1/directives/class-map.js","lit-html/directives/class-map.js":"https://ga.jspm.io/npm:lit-html@2.1.1/development/directives/class-map.js","lit-html/directives/if-defined.js":"https://ga.jspm.io/npm:lit-html@2.1.1/development/directives/if-defined.js","lit-html/directives/live.js":"https://ga.jspm.io/npm:lit-html@2.1.1/development/directives/live.js","lit-html/directives/style-map.js":"https://ga.jspm.io/npm:lit-html@2.1.1/development/directives/style-map.js","lit-html/lib/shady-render.js":"https://ga.jspm.io/npm:lit-html@1.4.1/lib/shady-render.js","lit-html/lit-html.js":"https://ga.jspm.io/npm:lit-html@1.4.1/lit-html.js","lit/decorators.js":"https://ga.jspm.io/npm:lit@2.1.1/decorators.js","lit/directive.js":"https://ga.jspm.io/npm:lit@2.1.1/directive.js","lit/directives/class-map.js":"https://ga.jspm.io/npm:lit@2.1.1/directives/class-map.js","lit/directives/if-defined.js":"https://ga.jspm.io/npm:lit@2.1.1/directives/if-defined.js","lit/directives/live.js":"https://ga.jspm.io/npm:lit@2.1.1/directives/live.js","lit/directives/style-map.js":"https://ga.jspm.io/npm:lit@2.1.1/directives/style-map.js","tslib":"https://ga.jspm.io/npm:tslib@1.14.1/tslib.es6.js","wicg-inert":"https://ga.jspm.io/npm:wicg-inert@3.1.1/dist/inert.js"},"https://ga.jspm.io/npm:@material/dialog@6.0.0-canary.781434a92.0/":{"@material/base/foundation":"https://ga.jspm.io/npm:@material/base@6.0.0-canary.781434a92.0/foundation.js"},"https://ga.jspm.io/npm:@material/mwc-base@1.0.0-canary.66f6244e.0/":{"@material/dom/ponyfill":"https://ga.jspm.io/npm:@material/dom@6.0.0-canary.781434a92.0/ponyfill.js"},"https://ga.jspm.io/npm:@material/mwc-dialog@1.0.0-canary.66f6244e.0/":{"@material/dom/ponyfill":"https://ga.jspm.io/npm:@material/dom@6.0.0-canary.781434a92.0/ponyfill.js"}}}</script>

    <script type="module" src="/frame.js"></script>
  </head>
  <body>
    <fallback-element></fallback-element>

<script type="module">
import { LitElement, html, css } from 'lit';
import { ifDefined } from 'lit/directives/if-defined.js';

import '@material/mwc-button';
import '@power-elements/json-viewer';

class FallbackElement extends LitElement {
  static get properties() {
    return {
      error: { type: Object },
      output: { type: Object },
      unsupported: { type: Boolean, reflect: true },
      publishableKey: { type: String, attribute: 'publishable-key', reflect: true },
      submitDisabled: { type: Boolean },
    }
  }

  static get styles() {
    return css`
      [hidden] { display: none !important; }

      :host {
        align-items: center;
        display: grid;
        grid-gap: 12px;
        grid-template-areas:
          'support support'
          'stripe submit'
          'output output';
      }

      stripe-elements { grid-area: stripe; }

      stripe-payment-request { grid-area: submit/stripe/stripe/submit; }

      mwc-button { grid-area: submit; }

      json-viewer { grid-area: output; }
    `;
  }

  constructor() {
    super();
    this.submitDisabled = true;
  }

  render() {
    return html`
      <output ?hidden="${this.unsupported === undefined}">
        Payment Request is ${this.unsupported ? 'un' : ''}supported on this Browser
      </output>

      <stripe-payment-request
          ?hidden="${this.output || this.unsupported}"
          @success="${this.onSuccess}"
          @fail="${this.onFail}"
          @error="${this.onError}"
          @unsupported="${this.onUnsupported}"
          @ready="${this.onReady}"
          publishable-key="${ifDefined(this.publishableKey)}"
          generate="source"
          request-payer-name
          request-payer-email
          request-payer-phone
          amount="326"
          label="Double Double"
          country="CA"
          currency="cad">
        <stripe-display-item data-amount="125" data-label="Double Double"></stripe-display-item>
        <stripe-display-item data-amount="199" data-label="Box of 10 Timbits"></stripe-display-item>
        <stripe-shipping-option data-id="pick-up" data-label="Pick Up" data-detail="Pick Up at Your Local Timmy's" data-amount="0"></stripe-shipping-option>
        <stripe-shipping-option data-id="delivery" data-label="Delivery" data-detail="Timbits to Your Door" data-amount="200"></stripe-shipping-option>
      </stripe-payment-request>

      <stripe-elements
          ?hidden="${this.output || !this.unsupported}"
          generate="source"
          publishable-key="${ifDefined(this.unsupported ? this.publishableKey : undefined)}"
          @change="${this.onChange}"
          @source="${this.onSuccess}"
          @error="${this.onError}"
      ></stripe-elements>

      <mwc-button
          ?hidden="${this.output || !this.unsupported}"
          ?disabled="${this.submitDisabled}"
          @click="${this.onClick}"
      >Submit</mwc-button>

      <json-viewer .object="${this.output}"></json-viewer>
    `;
  }

  onChange({ target: { complete, error } }) {
    this.submitDisabled = !(complete && !error);
  }

  onClick() {
    this.shadowRoot.querySelector('stripe-elements').submit();
  }

  onError({ target: { error } }) {
    this.error = error;
  }

  onFail(event) {
    this.output = event.detail;
  }

  onReady() {
    this.unsupported = false;
  }

  onSuccess(event) {
    this.output = event.detail;
  }

  onUnsupported(e) {
    this.unsupported = true;
  }
}

customElements.define('fallback-element', FallbackElement);
</script>

  </body>
</html>
